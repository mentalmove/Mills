function Move(f,a,i,l,g,e){e.piece.style.display="none";var j=true;var k=a[0];var h=a[1];var m=document.createElement("div");m.className="piece";m.style.backgroundColor="white";m.style.position="absolute";m.style.left=k+"px";m.style.top=h+"px";document.body.appendChild(m);function d(){document.body.onmouseup=null;document.getElementById("base").onmousemove=null}function c(){j=false;var o=0;for(var n=0;n<g.length;n++){if(Math.abs(g[n][0]-k)>40){continue}if(Math.abs(g[n][1]-h)>40){continue}rules.swap_pieces(f,l[n],"white");o=1;break}m.parentNode.removeChild(m);if(!o){e.piece.style.display="block"}move=null}function b(n){if(!j){d();return}k=n.clientX-i[0];h=n.clientY-i[1];m.style.left=k+"px";m.style.top=h+"px"}document.body.onmouseup=c;document.getElementById("base").onmousemove=b}function Place(e,a){this.piece;var c=this;function d(f,g){if(g-24<=0){f.parentNode.removeChild(f);return}f.style.opacity=g/100;setTimeout(d,16,f,(g-4))}this.set_piece=function(f){c.piece=document.createElement("div");c.piece.className="piece";c.piece.style.backgroundColor=f;b.appendChild(c.piece)};this.remove_piece=function(){if(!c.piece){return}d(c.piece,96);c.piece=null};this.enable_set=function(f){b.style.cursor="pointer";b.onclick=function(){if(!f(a)){return}c.set_piece("white")}};this.disable_set=function(){b.style.cursor="default";b.onclick=null};this.enable_remove=function(){c.piece.style.cursor="pointer";c.piece.onclick=function(){rules.remove_piece(a,"black")}};this.disable_remove=function(){if(c.piece){c.piece.style.cursor="default";c.piece.onclick=null}};this.enable_move=function(g,f){if(!c.piece){return}c.piece.style.cursor="pointer";c.piece.onmousedown=function(h){move=new Move(a,b.style.location,[h.layerX,h.layerY],g,f,c)}};this.disable_move=function(){if(c.piece){c.piece.onmousedown=null;c.piece.style.cursor="default"}};var b=document.createElement("div");b.className="place";e.appendChild(b);this.style=b.style;this.update_location=function(){b.style.location=get_position(b)}}function generate(){var f,e,b,g,d;var l=[document.getElementsByClassName("element")[0],document.getElementById("middle"),document.getElementById("inner")];var a=[];for(f=0;f<3;f++){for(e=0;e<8;e++){g=new Place(l[f],(f*8)+e);a.push(g)}}var k=[{left:"default",top:"default"},{left:"0px",right:"0px",top:"default",margin:"auto"},{right:"default",top:"default"},{right:"default",top:"0px",bottom:"0px",margin:"auto"},{right:"default",bottom:"default"},{left:"0px",right:"0px",bottom:"default",margin:"auto"},{left:"default",bottom:"default"},{left:"default",top:"0px",bottom:"0px",margin:"auto"}];var h=[];var c="-20px";for(f=0;f<3;f++){for(e=0;e<8;e++){g={};for(b in k[e]){d=k[e][b];g[b]=(d=="default")?c:d}h.push(g)}c="-44px"}for(f=0;f<a.length,f<h.length;f++){for(b in h[f]){a[f].style[b]=h[f][b]}}function m(){document.getElementById("base").style.width=get_window_size()[1]+"px"}window.onresize=m;m();return a}var move=null;new Interface(generate(),"begin");